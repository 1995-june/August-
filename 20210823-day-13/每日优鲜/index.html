<!--
 * @Author: your name
 * @Date: 2021-08-22 14:24:32
 * @LastEditTime: 2021-08-27 19:57:51
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \HTML排版案例d:\八月没有六月好\20210823-day-13\每日优鲜\index.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width = device-width,
    user-scalable = no,
    initial-scale = 1.0,
    maximum-scale = 1.0,
    minimum-scale = 1.0" />
    <title>每日优鲜</title>
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./fonts/iconfont.css">
    <!-- 轮播插件 -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
</head>

<body>

    <div id="wrap">
        <div class="search-wrap-active">
            <a href="./html/search.html">
                <div class="search"><i class="iconfont icon-fangdajing"></i><span>请输入关键字</span><button type="button">搜索</button></div>
            </a>
        </div>
        <div id="box">
            <div class="wrap-box">
                <h2>每日优鲜</h2>
                <div class="header">
                    <div class="top-address">
                        <div class="address">
                            <i class="iconfont icon-location"></i><a href="./html/receivingAddress.html">郑州市中原区纪检委</a>
                        </div>
                        <div class="small-bell">
                            <a href="#"><i class="iconfont icon-lingdang"></i></a>
                        </div>
                    </div>
                    <div class="characteristic-wrap">
                        <ul class="characteristic-one">
                            <li class="active">云超特卖</li>
                            <li>最快次日达</li>
                        </ul>
                        <span>|</span>
                        <ul class="characteristic-two">
                            <li class="active">产地直送</li>
                            <li>预计24H发货</li>
                        </ul>
                    </div>
                    <div class="search-aaa">
                        <div class="search-wrap">
                            <a href="./html/search.html" class="A">
                                <div class="search"><i class="iconfont icon-fangdajing"></i><span>请输入关键字</span><button type="button">搜索</button></div>
                            </a>
                        </div>
                    </div>
                    <div class="swiper-container">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="./images/loop1.jpg" alt=""></div>
                            <div class="swiper-slide"><img src="./images/loop2.jpg" alt=""></div>
                            <div class="swiper-slide"><img src="./images/loop3.jpg" alt=""></div>
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
                <div class="nav-active">
                    <nav>
                        <div class="nav-tab">
                            <div class="whole base">
                                <h4>全部</h4>
                            </div>
                            <div class="store-goods base">
                                <h3>囤货更省</h3>
                            </div>
                            <div class="grain-and-oil base">
                                <h3>粮油速食</h3>
                            </div>
                            <div class="drink base">
                                <h3>酒乳饮品</h3>
                            </div>
                            <div class="snacks base">
                                <h3>休闲零食</h3>
                            </div>
                            <div class="Meihu base">
                                <h3>美护日百</h3>
                            </div>
                            <div class="beauty-baby base">
                                <h3>母婴好物</h3>
                            </div>
                        </div>
                    </nav>
                </div>
                <div class="main">
                    <div class="content">
                        <div class="guarantee-wrap">
                            <dl>
                                <dt><i class="iconfont icon-zhengpinbaozhang2"></i></dt>
                                <dd>正品保障</dd>
                            </dl>
                            <dl>
                                <dt><i class="iconfont icon-jiaotonggongju_jiaotonggongju-huoche-21"></i></dt>
                                <dd>配送全国</dd>
                            </dl>
                            <dl>
                                <dt><i class="iconfont icon-erji"></i></dt>
                                <dd>售后无忧</dd>
                            </dl>
                        </div>
                        <div class="rolling-news-wrap">
                            <div class="rolling-news">
                                <p>受疫情影响，途径扬州武汉，江苏等地的进出快件时效将受到一定影响，还请您耐心等待！</p>
                            </div>
                        </div>
                        <div class="goods-nav-wrap">
                            <nav>
                                <dl>
                                    <dt>
                                <img src="./images/nav3.png" alt="">
                            </dt>
                                    <dd>水果蔬菜</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav44.png" alt="">
                            </dt>
                                    <dd>乳品烘培</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav8.png" alt="">
                            </dt>
                                    <dd>个护美妆</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav8.png" alt="">
                            </dt>
                                    <dd>健康保健</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav6.png" alt="">
                            </dt>
                                    <dd>速度食品</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav3.png" alt="">
                            </dt>
                                    <dd>水果蔬菜</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav44.png" alt="">
                            </dt>
                                    <dd>乳品烘培</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav8.png" alt="">
                            </dt>
                                    <dd>个护美妆</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav8.png" alt="">
                            </dt>
                                    <dd>健康保健</dd>
                                </dl>
                                <dl>
                                    <dt>
                                <img src="./images/nav6.png" alt="">
                            </dt>
                                    <dd>速度食品</dd>
                                </dl>
                            </nav>
                        </div>
                        <div class="img-more-wrap">
                            <div class="img-more">
                                <a href="#"><img src="./images/口碑推荐.png" alt=""></a>
                            </div>
                        </div>
                        <div class="bj-wrap">
                            <div id="bj">
                                <div class="goods-scrll-list-wrap">
                                    <div class="goods-scrll-list">
                                        <div class="goods">
                                            <div class="goods-x"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="seckill-wrap">
                            <div class="seckill">
                                <div class="left-seckill">
                                    <div class="title-wrap">
                                        <h3>今日秒杀</h3>
                                        <div class="count-down">
                                            <span>03</span><b>:</b><span>28</span><b>:</b><span>12</span>
                                        </div>
                                        <p>精选推荐 限时折扣</p>
                                    </div>
                                    <div class="con-img">
                                        <dl>
                                            <dt><img src="./images/速食面_10.jpg"></dt>
                                            <dd>￥61</dd>
                                        </dl>
                                        <dl>
                                            <dt><img src="./images/速食面_10.jpg"></dt>
                                            <dd>￥61</dd>
                                        </dl>
                                    </div>
                                </div>
                                <div class="right-supermarket">
                                    <div class="title-wrap">
                                        <h3>今日超市</h3>
                                        <div class="count-down">
                                            <img src="./images/微信图片_20210727145629_05.jpg" alt="">
                                        </div>
                                        <p>精选推荐 限时折扣</p>
                                    </div>
                                    <div class="con-img">
                                        <dl>
                                            <dt><img src=".//images/刘莱_03.jpg"></dt>
                                            <dd>￥61</dd>
                                        </dl>
                                        <dl>
                                            <dt><img src=".//images/刘莱_03.jpg"></dt>
                                            <dd>￥61</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="nav-wrap">
                            <nav>
                                <div class="nav-tab">
                                    <div class="whole base">
                                        <h4>全部</h4>
                                        <p>精选好物</p>
                                    </div>
                                    <div class="store-goods base">
                                        <h3>囤货更省</h3>
                                        <span>加量不加价</span>
                                    </div>
                                    <div class="grain-and-oil base">
                                        <h3>粮油速食</h3>
                                        <span>有滋有味</span>
                                    </div>
                                    <div class="drink base">
                                        <h3>酒乳饮品</h3>
                                        <span>乐爽酷饮</span>
                                    </div>
                                    <div class="snacks base">
                                        <h3>休闲零食</h3>
                                        <span>美食每刻</span>
                                    </div>
                                    <div class="Meihu base">
                                        <h3>美护日百</h3>
                                        <span>精致生活</span>
                                    </div>
                                    <div class="beauty-baby base">
                                        <h3>母婴好物</h3>
                                        <span>妈妈推荐</span>
                                    </div>
                                </div>
                            </nav>
                        </div>
                        <div class="goods-wrap">
                            <div class="goods-list">
                                <div class="goods">
                                </div>
                                <div class="up">上拉加载更多</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <div class="footer-nav">
                <a href="#">
                    <dl>
                        <dt>
                            <img src="./images/home-active.5f430fd.png" alt="">
                        </dt>
                        <dd>首页</dd>
                    </dl>
                </a>
                <a href="./html/homeClassification.html">
                    <dl>
                        <dt>
                            <img src="./images/下载 (2).png" alt="">
                        </dt>
                        <dd>分类</dd>
                    </dl>
                </a>
                <a href="./html/shoppingCart.html">
                    <dl>
                        <dt>
                            <img src="./images/下载 (4).png" alt="">
                        </dt>
                        <dd>购物车
                            <span class="num">0</span>
                        </dd>
                    </dl>
                </a>
                <a href="#">
                    <dl>
                        <dt>
                            <img src="./images/下载 (5).png" alt="">
                        </dt>
                        <dd>我的</dd>
                    </dl>
                </a>
            </div>
        </div>
    </div>
    <!-- 轮播插件 -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="./lib/bscroll .js"></script>
    <script src="./js/ajax.js"></script>
    <script src="./js/index.js"></script>
    <script>
        // 滚动
        new BScroll('.goods-scrll-list-wrap', {
            scrollX: true,
        })

        // 滚动
        new BScroll('.nav-wrap', {
            scrollX: true,
        })

        // 滚动
        new BScroll('.nav-active', {
            scrollX: true,
        })

        var pullUp = document.querySelector('.up')

        var bs = new BScroll('#box', {
            probeType: 2,
            // 0 ~ 1 代表手指不在屏幕滑动  2 代表手指在屏幕滑动 3 代表手指离开屏幕
            pullDownRefresh: { // 选项对象
                threshold: 90, // 配置顶部下拉的距离来决定刷新时机。
                stop: 40 //回弹悬停的距离。  
            },
            // 触发上拉事件的阈值。
            pullUpLoad: {
                threshold: 90,
                stop: 40 //回弹悬停的距离。  

            }
        })

        var goods = document.querySelector('.goods-wrap > .goods-list > .goods');
        // 当顶部下拉的距离大于 threshold 值时，触发一次 pullingDown
        bs.on('pullingUp', function() {
            pullUp.innerHTML = '正在加载';
            ajax('./lib/data.json', 'get', {}, function(res) {
                setTimeout(function() {
                    renderUpDara(res);
                    bs.finishPullUp(); //结束上拉加载行为。
                    bs.refresh();
                }, 1000)
            })
        })

        function renderUpDara(res) {
            var item = res.list;
            goods.innerHTML += item.map(function(val) {
                return `
                    <dl>
                        <dt>
                            <a href="#"><img src="${val.img}" alt=""></a>
                        </dt>
                        <dd>
                            <h6>${val.goods_name}</h6>
                            <p>${val.desc}</p>
                            <div class="subtitle-wrap">
                                <span>任选两件</span>
                                <span>最快次日达</span>
                            </div>
                            <div class="price-wrap">
                                <span>￥${val.goods_price}</span> <button type="button">+</button>
                            </div>
                        </dd>
                    </dl>`
            })
            var dl = goods.querySelectorAll('dl');
            PageEvent(dl)
            var btns = goods.querySelector('button')
            btnAdd(btns)

        }

        function PageEvent(dl) {
            dl.forEach((val) => {
                val.addEventListener('touchend', function() {
                    var dataObj = {
                        "img": this.children[0].children[0].children[0].src,
                        "title": this.children[1].children[0].innerHTML,
                        "con": this.children[1].children[1].innerHTML,
                        "subtitle": this.children[1].children[2].children[0].innerHTML,
                        "price": this.children[1].children[3].children[0].innerHTML,
                    }
                    localStorage.setItem('pageData', JSON.stringify(dataObj));
                    location.href = './html/details.html';
                })
            })
        }

        /* 吸顶 */
        var searchAaa = document.querySelector('.search-aaa');
        var searchWrapActive = document.querySelector('.search-wrap-active');
        var nav = searchWrapActive.offsetHeight;
        var activeTop = searchAaa.offsetTop;

        bs.on('scroll', function() {
            if (Math.abs(bs.y) >= activeTop - nav) {
                searchWrapActive.style.display = 'block';
            } else {
                searchWrapActive.style.display = 'none';
            }
        })

        // 获取本地存储
        var addressWrap = document.querySelector('.address > a');
        var arr = JSON.parse(localStorage.getItem('cityLis'));
        addressWrap.innerHTML = arr.con;

        function btnAdd(btns) {
            btns.forEach((time) => {
                time.addEventListener('touchend', function() {
                    console.log(555);
                })
            })
        }
    </script>
</body>

</html>